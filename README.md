# you can bot - чат бот по профориентации

## Информация
### Описание проекта
Данный проект содержит в себе телеграм бота, который позволяет подросткам проходить онлайн-профориентацию, чтобы найти свое призвание и максимально реализовать свои способности.

### Особенности

- Наличие нескольких объемных тестов, которые можно проходить прямо через телеграм-бота;
- Алгоритмы по высчитыванию расшифровки тестов, позволяют получить результат тестов практически моментально;
- Наличие бэкенда с базой данных, который служит для хранения результатов тестов и для их обработки;
- Подростки могут связываться с психологом и задавать вопросы через бота;
- Психологи могут работать с результатами тестов подростков и отвечать на их вопросы через удобную админку.

### Используемый стек

- Poetry в качестве пакетного менеджера проекта;
- python-telegram-bot 20+ в качестве асинхронного telegram-интерфейса;
- Django REST Framework в качестве REST API бэкенд сервера;
- PostgreSQL в качестве СУБД;
- Docker с docker-compose в качестве инструмента для автоматизации развёртывания и управления приложением.

### Системные требования
- Python 3.11+;
- Docker (19.03.0+) c docker compose;
- [Poetry](https://python-poetry.org/docs/#installing-with-the-official-installer).


## Эксплуатация и тестирование

### Установка проекта локально (без docker)

1. Устанавливаем инструмент для работы с виртуальным окружением и сборки пакетов **poetry**:

<details>
<summary>
Информация по poetry и его установка
</summary>

Poetry - это инструмент для управления зависимостями и виртуальными окружениями, также может использоваться для сборки пакетов. В этом проекте Poetry необходим для дальнейшей разработки приложения, его установка <b>обязательна</b>.<br>

<details>
 <summary>
 Как скачать и установить?
 </summary>

### Установка:

Установите poetry следуя [инструкции с официального сайта](https://python-poetry.org/docs/#installation).
<details>
 <summary>
 Команды для установки:
 </summary>
Для UNIX-систем и Bash on Windows вводим в консоль следующую команду:

> *curl -sSL https://install.python-poetry.org | python -*

Для WINDOWS PowerShell:

> *(Invoke-WebRequest -Uri https://install.python-poetry.org -UseBasicParsing).Content | python -*
</details>
<br>
После установки перезапустите оболочку и введите команду

> poetry --version

Если установка прошла успешно, вы получите ответ в формате

> Poetry (version 1.2.0)

Для дальнейшей работы введите команду:

> poetry config virtualenvs.in-project true

Выполнение данной команды необходимо для создания виртуального окружения в
папке проекта.

После предыдущей команды создадим виртуальное окружение нашего проекта с
помощью команды:

> poetry install

Результатом выполнения команды станет создание в корне проекта папки .venv.
Зависимости для создания окружения берутся из файлов poetry.lock (приоритетнее)
и pyproject.toml

Для добавления новой зависимости в окружение необходимо выполнить команду

> poetry add <package_name>

_Пример использования:_

> poetry add starlette

Также poetry позволяет разделять зависимости необходимые для разработки, от
основных.
Для добавления зависимости необходимой для разработки и тестирования необходимо
добавить флаг ***--group dev***

> poetry add <package_name> --group dev

_Пример использования:_

> poetry add pytest --group dev

</details>

<details>
 <summary>
 Порядок работы после настройки
 </summary>

<br>

Чтобы активировать виртуальное окружение, введите команду:

> poetry shell

Существует возможность запуска скриптов и команд с помощью команды без
активации окружения:

> poetry run <script_name>.py

_Примеры:_

> poetry run python script_name>.py
>
> poetry run pytest
>
> poetry run black

Порядок работы в оболочке не меняется. Пример команды для Win:

> python src\run_bot.py

Доступен стандартный метод работы с активацией окружения в терминале с помощью команд:

Для WINDOWS:

> source .venv/Scripts/activate

Для UNIX:

> source .venv/bin/activate

</details>


</details>

2. Клонируем репозиторий и переходим в его директорию:

```shell
git clone https://github.com/Studio-Yandex-Practicum/you_can_bot.git && cd you_can_bot
```

3. Копируем файл **.env.example** с новым названием **.env** и заполняем его необходимыми данными:

```shell
cp .env.example .env
```
```shell
nano .env
```

4. Подготавливаем бэкенд к работе:

```shell
python src/backend/manage.py migrate
```

### Запуск проекта локально (без docker)

Если нужен доступ в админскую часть для управления данными, создаем администратора:

```shell
python src/backend/manage.py createsuperuser
```

Для запуска REST API бэкенда используем команду:

```shell
python src/backend/manage.py runserver
```

Для запуска телеграм-бота используем команду:
```shell
python src/bot/run_bot.py
```

### Запуск тестов

Чтобы запустить unittest тестирование работы функционала проекта, нужно перейти в каталог со скриптом **manage.py**:
```shell
cd src/backend
```

И выполнить команду:

```shell
python manage.py test -v 2
```